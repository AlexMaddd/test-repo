import{r as t,j as e,S as Q,Q as P,G as C,a6 as X,a7 as Y,a8 as Z,y as b,K as v,V as W,W as I,X as H,Y as y,Z as l,$ as U,a5 as F,ad as de,C as M,F as he,z as J,ae as xe,N as ue,P as fe,R as me,U as q,a2 as K,a3 as pe,a4 as ge}from"./index-c7565a54.js";import{u as ee}from"./hooks-51dc8d91.js";import"./useDispatch-d33b0fcf.js";const je=t.forwardRef(function(x,d){return e.jsx(Q,{direction:"down",ref:d,...x})}),Ce=h=>{const x=ee(),{open:d,onClose:S}=h,{callApi:E,loading:u}=P({method:"get",url:"employees",immediate:!1,onSuccess(i){i!=null&&B(i==null?void 0:i.data.data)}}),{callApi:m}=P({method:"get",url:"branches/assign-employee",immediate:!1,onSuccess(i){let a=i.data.data;C.fire({icon:"success",title:"Success",text:"Saved",showConfirmButton:!1,timer:3e3}).then(()=>{let n=f.reduce((r,c)=>(c.id===a.employee_id&&(r=c),r));x({type:"branch/branchAddEmployee",payload:{id:a.id,branch_id:a.branch_id,employee_id:a.employee_id,employee:n}}),g()})}}),[f,B]=t.useState([]),D=["Employee Code","First Name","Middle Name","Last Name","Action"],p=i=>{C.fire({icon:"question",title:"Confirm",text:"Add employee to current branch?",showConfirmButton:!0}).then(a=>{a.isConfirmed&&m({id:i.id})})},g=()=>{S()};return t.useEffect(()=>{E()},[]),e.jsx(X,{open:d,onClose:g,TransitionComponent:je,fullWidth:!0,maxWidth:"md",children:e.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(Z,{handleClose:g,action:"Add",module:"Employee"}),e.jsx(b,{sx:{display:"flex",flexDirection:"column",gap:3,padding:2,width:"100%",alignItems:"center"},children:u?e.jsx(v,{}):e.jsx(W,{children:e.jsxs(I,{stickyHeader:!0,children:[e.jsx(H,{sx:{backgroundColor:"#F5F5F5"},children:e.jsx(y,{children:D.map((i,a)=>e.jsx(l,{size:"small",sx:{fontWeight:"bold",backgroundColor:"#F5F5F5",padding:"15px"},align:"center",children:i},a))})}),e.jsx(U,{children:f.map((i,a)=>e.jsxs(y,{children:[e.jsx(l,{align:"center",children:i.employee_code}),e.jsx(l,{align:"center",children:i.fname}),e.jsx(l,{align:"center",children:i.mname}),e.jsx(l,{align:"center",children:i.lname}),e.jsx(l,{align:"center",children:e.jsx(F,{color:"purple",icon:e.jsx(de,{}),onClick:()=>p(i),title:"Add Employee"})})]},a))})]})})})]})})},be=t.forwardRef(function(x,d){return e.jsx(Q,{direction:"down",ref:d,...x})}),ye=h=>{const{open:x,onClose:d}=h,S=ee(),{callApi:E}=P({method:"delete",url:"branches/remove-employee",immediate:!1,onSuccess(n){C.fire({icon:"success",title:"Success",text:"Saved",showConfirmButton:!1,timer:3e3}).then(()=>{S({type:"branch/branchDeleteEmployee",payload:{id:n.id}})})}}),u=M(n=>{var r,c;return(c=(r=n.root)==null?void 0:r.branch)==null?void 0:c.name}),m=M(n=>{var r,c;return(c=(r=n.root)==null?void 0:r.branch)==null?void 0:c.employees}),[f,B]=t.useState(!1),[D,p]=t.useState(!1),g=["Employee Code","First Name","Middle Name","Last Name","Actions"],i=()=>{d()},a=n=>{C.fire({icon:"warning",title:"Confirm",text:"Remove employee from current branch?",showConfirmButton:!0}).then(r=>{r.isConfirmed&&E({id:n.employee_id})})};return t.useEffect(()=>{},[f]),t.useEffect(()=>{},[]),e.jsxs(e.Fragment,{children:[e.jsx(t.Suspense,{fallback:e.jsx(v,{}),children:e.jsx(Ce,{open:D,onClose:()=>p(!1)})}),e.jsx(X,{open:x,onClose:i,TransitionComponent:be,fullWidth:!0,maxWidth:"md",children:e.jsxs(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(Z,{handleClose:i,action:u+" Branch",module:"Employees"}),e.jsxs(b,{sx:{display:"flex",flexDirection:"column",gap:3,padding:2,width:"100%",alignItems:"center"},children:[e.jsx(he,{sx:{alignSelf:"end",background:"#8C57FF",borderRadius:"10px",height:"40px"},onClick:()=>p(!0),variant:"contained",children:e.jsx(J,{fontSize:20,children:"+"})}),e.jsx(W,{children:e.jsxs(I,{stickyHeader:!0,children:[e.jsx(H,{sx:{backgroundColor:"#F5F5F5"},children:e.jsx(y,{children:g.map((n,r)=>e.jsx(l,{size:"small",sx:{fontWeight:"bold",backgroundColor:"#F5F5F5",padding:"15px"},align:"center",children:n},r))})}),e.jsx(U,{children:m?m.map((n,r)=>{var c,_,k,A;return e.jsxs(y,{children:[e.jsx(l,{align:"center",children:(c=n==null?void 0:n.employee)==null?void 0:c.employee_code}),e.jsx(l,{align:"center",children:(_=n==null?void 0:n.employee)==null?void 0:_.fname}),e.jsx(l,{align:"center",children:(k=n==null?void 0:n.employee)==null?void 0:k.mname}),e.jsx(l,{align:"center",children:(A=n==null?void 0:n.employee)==null?void 0:A.lname}),e.jsx(l,{align:"center",children:e.jsx(F,{color:"red",icon:e.jsx(xe,{}),onClick:()=>a(n),title:"Remove Employee"})})]},r)}):null})]})})]})]})})]})},Se=t.lazy(()=>ue(()=>import("./CRUDDialog-97832b07.js"),["assets/CRUDDialog-97832b07.js","assets/index-c7565a54.js","assets/index-fc468ed0.css"])),Fe=()=>{const{error:h,loading:x,callApi:d}=P({method:"get",url:"branches",immediate:!1,onSuccess(s){if(s!=null){k(s==null?void 0:s.data.data),(s==null?void 0:s.data.next_page_url)==null?p(!1):p(!0),(s==null?void 0:s.data.prev_page_url)==null?i(!1):i(!0);let o=s==null?void 0:s.data.links.length;n(o-2)}}}),{callApi:S,loading:E}=P({method:"delete",url:"branches",immediate:!1,onSuccess(){C.fire({icon:"success",title:"Success",text:"Saved",showConfirmButton:!1,timer:3e3}).then(()=>{R(!0)})}}),[u,m]=t.useState(1),[f,B]=t.useState(6),[D,p]=t.useState(!0),[g,i]=t.useState(!0),[a,n]=t.useState(0),[r,c]=t.useState(""),[_,k]=t.useState([]),[A,L]=t.useState(),[T,O]=t.useState(!1),[se,V]=t.useState(!1),[te,ne]=t.useState(""),[$,R]=t.useState(!1),[ie,oe]=t.useState(""),le=["Name","Address","Actions"],re=((s,o=300)=>{let j;return function(...z){clearTimeout(j),j=setTimeout(()=>s.apply(this,z),o)}})(s=>{oe(s),m(1),d({search:s,page:1,size:f,orderBy:{name:"ASC"}})}),w=(s,o)=>{s=="Delete"?C.fire({icon:"warning",title:"Confirm",text:"Proceed with delete?"}).then(j=>{j.isConfirmed&&S({id:o==null?void 0:o.id})}):(ne(s),L(o),s==="Employees"?V(!0):O(!0))},ae=s=>e.jsx(e.Fragment,{children:e.jsx(l,{children:e.jsxs(b,{sx:{display:"flex",gap:3,justifyContent:"center"},children:[e.jsx(F,{color:"blue",icon:"View",onClick:()=>w("View",s),title:"View"}),e.jsx(F,{color:"green",icon:"Edit",onClick:()=>w("Edit",s),title:"Edit"}),e.jsx(F,{color:"red",icon:"Delete",onClick:()=>w("Delete",s),title:"Delete"})]})},s.id)}),G=s=>{s=="Next"?m(o=>o+1):m(o=>o-1)};return t.useEffect(()=>{let s=location.pathname.split("/"),o=s[s.length-1].split("-"),j="";o.map(z=>{let N=z.split("");N[0]=N[0].toUpperCase();let ce=N.toString().replace(/,/g,"");j+=ce+" "}),c(j),d({search:"",page:u,size:f,orderBy:{name:"ASC"}})},[]),t.useEffect(()=>{d({search:ie,page:u,size:f,orderBy:{name:"ASC"}})},[u]),t.useEffect(()=>{h.length>0&&C.fire({icon:"error",title:"Error",text:h,showConfirmButton:!1,timer:3e3})},[h]),t.useEffect(()=>{$==!0&&(d({search:"",page:u,size:f,orderBy:{name:"ASC"}}),R(!1))},[$]),t.useEffect(()=>{T==!1&&A!=null&&L(void 0)},[T]),e.jsxs(e.Fragment,{children:[e.jsxs(t.Suspense,{fallback:e.jsx(v,{}),children:[e.jsx(Se,{open:T,onClose:()=>O(!1),action:te,selectedData:A,refresh:()=>R(!0)}),e.jsx(ye,{open:se,onClose:()=>V(!1)})]}),e.jsx(J,{variant:"h6",fontWeight:"bold",sx:{ml:"50px",mb:"20px"},children:"Branches"}),e.jsxs(fe,{elevation:24,sx:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"700px",borderRadius:"20px",p:"30px",gap:2},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",justifyContent:"start",gap:1},children:[e.jsx(me,{placeholder:"Search Branches...",size:"small",onChange:s=>re(s.target.value),sx:{width:"50%"}}),e.jsx(q,{color:"primary",icon:"Add",title:"Add",onClick:()=>w("Add")}),e.jsx(q,{color:"secondary",icon:"Employee",title:"Add Employee",onClick:()=>w("Employees")})]}),x&&E?e.jsx(b,{sx:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:e.jsx(v,{})}):e.jsx(W,{sx:{flexGrow:1},children:e.jsxs(I,{stickyHeader:!0,children:[e.jsx(H,{sx:{backgroundColor:"#F5F5F5"},children:e.jsx(y,{children:le.map((s,o)=>e.jsx(l,{size:"small",sx:{fontWeight:"bold",backgroundColor:"#F5F5F5",padding:"15px"},align:"center",children:s},o))})}),e.jsx(U,{children:_.map(s=>e.jsxs(y,{children:[e.jsx(l,{align:"center",children:s.name}),e.jsx(l,{align:"center",children:s.address}),ae(s)]},s.id))})]})}),e.jsxs(b,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center"},children:[e.jsx(K,{size:"medium",disabled:!g,onClick:()=>G("Prev"),children:e.jsx(pe,{})}),u+" of "+a,e.jsx(K,{size:"medium",disabled:!D,onClick:()=>G("Next"),children:e.jsx(ge,{})})]})]})]})};export{Fe as default};
