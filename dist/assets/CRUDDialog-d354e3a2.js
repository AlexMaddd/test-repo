import{r as s,j as o,S as A,Q as _,a6 as B,a7 as O,a8 as q,a9 as E,y as I,aa as d,ag as $,F as H,z as L,G as b}from"./index-c7565a54.js";const M=s.forwardRef(function(m,c){return o.jsx(A,{direction:"down",ref:c,...m})}),N=g=>{const{open:m,onClose:c,action:a,selectedData:e,refresh:w}=g,{callApi:F}=_({method:"get",url:"customers",immediate:!1,onSuccess(t){t!=null&&f(t.data.data)}}),{callApi:v}=_({method:a==="Add"?"post":"put",url:"vehicles",immediate:!1,onSuccess(){b.fire({icon:"success",title:"Success",text:"Saved",showConfirmButton:!1,timer:3e3}).then(()=>{x()})}}),[C,f]=s.useState([]),[u,S]=s.useState(!1),[y,p]=s.useState({id:"",fname:"",mname:"",lname:"",email:"",contact_number:""}),[j,P]=s.useState(""),[U,W]=s.useState(1),[R,V]=s.useState(6),x=()=>{f([]),w(),c()},T=((t,r=1e3)=>{let l;return function(...h){clearTimeout(l),l=setTimeout(()=>t.apply(this,h),r)}})(t=>{P(t),W(1),F({search:t,page:1,size:R,orderBy:{lname:"ASC"}})}),k=t=>{if((t==null?void 0:t.customer_id)!==void 0){let r={...t};a==="Edit"&&(r.id=e==null?void 0:e.id),b.fire({icon:"question",title:"Confirm",text:"Proceed with save?",showConfirmButton:!0}).then(l=>{l.isConfirmed&&v(r)})}else b.fire({icon:"warning",title:"Warning",text:"Select customer",showConfirmButton:!1,timer:2500})};return s.useEffect(()=>(a==="View"&&S(!0),a!="Add"&&p(e!=null&&e.customer?e==null?void 0:e.customer:{id:"",fname:"",mname:"",lname:"",email:"",contact_number:""}),()=>{S(!1),p({id:"",fname:"",mname:"",lname:"",email:"",contact_number:""})}),[m]),o.jsx(B,{open:m,onClose:x,TransitionComponent:M,fullWidth:!0,maxWidth:"sm",children:o.jsxs(O,{sx:{display:"flex",flexDirection:"column",gap:1},children:[o.jsx(q,{handleClose:x,action:a,module:"Vehicles"}),o.jsx(E,{initialValues:{maker:e!=null&&e.maker?e.maker:"",model:e!=null&&e.model?e.model:"",plate_number:e!=null&&e.plate_number?e.plate_number:"",customer_id:e!=null&&e.customer_id?e.customer_id:""},onSubmit:t=>{k(t)},children:({values:t,handleChange:r,setFieldValue:l,handleSubmit:h})=>o.jsx(o.Fragment,{children:o.jsxs(I,{component:"form",onSubmit:h,sx:{display:"flex",flexDirection:"column",gap:3,padding:2},children:[o.jsx(d,{required:!0,name:"maker",label:"Maker",variant:"outlined",size:"small",fullWidth:!0,value:t.maker,onChange:r,sx:{fieldset:{borderColor:"#8C57FF",borderRadius:"10px"}},disabled:u}),o.jsx(d,{required:!0,name:"model",label:"Model",variant:"outlined",size:"small",fullWidth:!0,value:t.model,onChange:r,sx:{fieldset:{borderColor:"#8C57FF",borderRadius:"10px"}},disabled:u}),o.jsx(d,{required:!0,name:"plate_number",label:"Plate Number",variant:"outlined",size:"small",fullWidth:!0,value:t.plate_number,onChange:r,sx:{fieldset:{borderColor:"#8C57FF",borderRadius:"10px"}},disabled:u}),o.jsx($,{disablePortal:!0,id:"combo-box-demo",options:C??[],getOptionKey:i=>i.id??"",getOptionLabel:i=>i.id!=""?`${i.lname}, ${i.fname} ${i.mname}`:"",isOptionEqualToValue:(i,n)=>i.id===n.id,noOptionsText:j.length>0&&C.length===0?"Customer doesn't exist":"Search for customer",value:y,onChange:(i,n,z)=>{n!=null?(l("customer_id",n.id),p(n)):z==="clear"&&f([])},fullWidth:!0,size:"small",disabled:u,ListboxProps:{style:{maxHeight:"6rem"}},componentsProps:{popper:{modifiers:[{name:"flip",enabled:!1}]}},renderInput:i=>o.jsx(d,{...i,label:"Owner",value:j,onChange:n=>T(n.target.value)})}),o.jsx(H,{variant:"contained",type:"submit",sx:{borderRadius:"10px",width:"120px",height:"40px",mr:"10px",alignSelf:"end",backgroundColor:"#8C57FF"},children:o.jsx(L,{fontSize:"12px",fontWeight:"bold",children:a})})]})})})]})})};export{N as default};
