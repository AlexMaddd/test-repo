import{r as t,N as M,Q as D,G as p,j as s,K as _,z as Q,P as X,y as d,R as Y,U as Z,V as q,W as J,X as ee,Y as E,Z as l,$ as se,a2 as v,a3 as te,a4 as ne,a5 as C}from"./index-c7565a54.js";const re=t.lazy(()=>M(()=>import("./CRUDDialog-de415a6d.js"),["assets/CRUDDialog-de415a6d.js","assets/index-c7565a54.js","assets/index-fc468ed0.css"])),ce=()=>{const{callApi:i,loading:T,error:u}=D({method:"get",url:"customers",immediate:!1,onSuccess(e){if(e!=null){H(e==null?void 0:e.data.data),(e==null?void 0:e.data.next_page_url)==null?j(!1):j(!0),(e==null?void 0:e.data.prev_page_url)==null?S(!1):S(!0);let n=e==null?void 0:e.data.links.length;N(n-2)}}}),{callApi:k}=D({method:"delete",url:"customers",immediate:!1,onSuccess(){p.fire({icon:"success",title:"Success",text:"Deleted",showConfirmButton:!1,timer:3e3}).then(()=>{f(!0)})}}),[a,x]=t.useState(1),[o,le]=t.useState(6),[B,j]=t.useState(!0),[R,S]=t.useState(!0),[z,N]=t.useState(0),[ae,I]=t.useState(""),[F,H]=t.useState([]),[P,A]=t.useState(),[h,y]=t.useState(!1),[U,V]=t.useState(""),[b,f]=t.useState(!0),[W,O]=t.useState(""),G=((e,n=300)=>{let r;return function(...m){clearTimeout(r),r=setTimeout(()=>e.apply(this,m),n)}})(e=>{O(e),x(1),i({search:e,page:1,size:o,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})}),L=["First Name","Middle Name","Last Name","Email","Contact Number","Actions"],$=e=>s.jsx(s.Fragment,{children:s.jsx(l,{children:s.jsxs(d,{sx:{display:"flex",justifyContent:"center",gap:3},children:[s.jsx(C,{color:"blue",icon:"View",onClick:()=>c("View",e),title:"View"}),s.jsx(C,{color:"green",icon:"Edit",onClick:()=>c("Edit",e),title:"Edit"}),s.jsx(C,{color:"red",icon:"Delete",onClick:()=>c("Delete",e),title:"Delete"})]})},e.id)}),c=(e,n)=>{e=="Delete"?p.fire({icon:"warning",title:"Confirm",text:"Proceed with delete?"}).then(r=>{r.isConfirmed&&k({id:n==null?void 0:n.id})}):(V(e),A(n),y(!0))},w=e=>{e=="Next"?x(n=>n+1):x(n=>n-1)};return t.useEffect(()=>{let e=location.pathname.split("/"),n=e[e.length-1].split("-"),r="";n.map(m=>{let g=m.split("");g[0]=g[0].toUpperCase();let K=g.toString().replace(/,/g,"");r+=K+" "}),I(r),i({search:"",page:a,size:o,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})},[]),t.useEffect(()=>{i({search:W,page:a,size:o,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})},[a]),t.useEffect(()=>{u.length>0&&p.fire({icon:"error",title:"Error",text:u,showConfirmButton:!1,timer:3e3})},[u]),t.useEffect(()=>{b==!0&&(i({search:"",page:a,size:o,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}}),f(!1))},[b]),t.useEffect(()=>{h==!1&&P!=null&&A(void 0)},[h]),s.jsxs(s.Fragment,{children:[s.jsx(t.Suspense,{fallback:s.jsx(_,{}),children:s.jsx(re,{open:h,onClose:()=>y(!1),action:U,selectedData:P,refresh:()=>f(!0)})}),s.jsx(Q,{variant:"h6",fontWeight:"bold",sx:{ml:"50px",mb:"20px"},children:"Customers"}),s.jsxs(X,{elevation:24,sx:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"700px",borderRadius:"20px",p:"30px",gap:3},children:[s.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"start",gap:1},children:[s.jsx(Y,{placeholder:"Search Customers...",size:"small",onChange:e=>G(e.target.value),sx:{width:"50%"}}),s.jsx(Z,{color:"primary",icon:"Add",title:"Add",onClick:()=>c("Add")})]}),T?s.jsx(d,{sx:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:s.jsx(_,{})}):s.jsx(q,{sx:{flexGrow:1},children:s.jsxs(J,{stickyHeader:!0,children:[s.jsx(ee,{children:s.jsx(E,{children:L.map((e,n)=>s.jsx(l,{size:"small",align:"center",sx:{fontWeight:"bold",backgroundColor:"#F5F5F5",padding:"15px"},children:e},n))})}),s.jsx(se,{children:F.map(e=>s.jsxs(E,{children:[s.jsx(l,{align:"center",children:e.fname}),s.jsx(l,{align:"center",children:e.mname}),s.jsx(l,{align:"center",children:e.lname}),s.jsx(l,{align:"center",children:e.email}),s.jsx(l,{align:"center",children:e.contact_number}),$(e)]},e.id))})]})}),s.jsxs(d,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center"},children:[s.jsx(v,{size:"medium",disabled:!R,onClick:()=>w("Prev"),children:s.jsx(te,{})}),a+" of "+z,s.jsx(v,{size:"medium",disabled:!B,onClick:()=>w("Next"),children:s.jsx(ne,{})})]})]})]})};export{ce as default};
