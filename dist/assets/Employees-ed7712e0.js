import{r as t,N as M,Q as D,G as m,j as s,K as w,z as Q,P as X,y as c,R as Y,U as Z,V as q,W as J,X as ee,Y as B,Z as l,$ as se,a0 as te,a1 as ne,a2 as k,a3 as le,a4 as ae,a5 as j}from"./index-c7565a54.js";const re=t.lazy(()=>M(()=>import("./CRUDDialog-353df414.js"),["assets/CRUDDialog-353df414.js","assets/index-c7565a54.js","assets/index-fc468ed0.css","assets/DatePicker-a8dcbf82.js","assets/listItemButtonClasses-07749e4a.js"])),xe=()=>{const{error:d,callApi:i,loading:v}=D({method:"get",url:"employees",immediate:!1,onSuccess(e){if(e!=null){U(e==null?void 0:e.data.data),(e==null?void 0:e.data.next_page_url)==null?C(!1):C(!0),(e==null?void 0:e.data.prev_page_url)==null?S(!1):S(!0);let n=e==null?void 0:e.data.links.length;F(n-2)}}}),{callApi:T}=D({method:"delete",url:"employees",immediate:!1,onSuccess(){m.fire({icon:"success",title:"Success",text:"Saved",showConfirmButton:!1,timer:3e3}).then(()=>{f(!0)})}}),[r,x]=t.useState(1),[u,ie]=t.useState(6),[R,C]=t.useState(!0),[z,S]=t.useState(!0),[N,F]=t.useState(0),[oe,I]=t.useState(""),[H,U]=t.useState([]),[y,P]=t.useState(),[h,A]=t.useState(!1),[V,W]=t.useState(""),[b,f]=t.useState(!0),[_,O]=t.useState(""),G=((e,n=300)=>{let a;return function(...p){clearTimeout(a),a=setTimeout(()=>e.apply(this,p),n)}})(e=>{O(e),x(1),i({search:e,page:1,size:u,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})}),L=["Employee Number","First Name","Middle Name","Last Name","Birthday","Employement Status","Start Date","End Date","Actions"],$=e=>s.jsx(s.Fragment,{children:s.jsx(l,{align:"center",children:s.jsxs(c,{sx:{display:"flex",justifyContent:"center",gap:3},children:[s.jsx(j,{color:"blue",icon:"View",onClick:()=>o("View",e),title:"View"}),s.jsx(j,{color:"green",icon:"Edit",onClick:()=>o("Edit",e),title:"Edit"}),s.jsx(j,{color:"red",icon:"Delete",onClick:()=>o("Delete",e),title:"Delete"})]})},e.id)}),o=(e,n)=>{e=="Delete"?m.fire({icon:"warning",title:"Confirm",text:"Proceed with delete?"}).then(a=>{a.isConfirmed&&T({id:n==null?void 0:n.id})}):(W(e),P(n),A(!0))},E=e=>{e=="Next"?x(n=>n+1):x(n=>n-1)};return t.useEffect(()=>{let e=location.pathname.split("/"),n=e[e.length-1].split("-"),a="";n.map(p=>{let g=p.split("");g[0]=g[0].toUpperCase();let K=g.toString().replace(/,/g,"");a+=K+" "}),I(a),i({search:"",page:r,size:u,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})},[]),t.useEffect(()=>{i({search:_,page:r,size:u,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}})},[r]),t.useEffect(()=>{b==!0&&(i({search:_,page:r,size:6,orderBy:{fname:"ASC",mname:"ASC",lname:"ASC"}}),f(!1))},[b]),t.useEffect(()=>{d.length>0&&m.fire({icon:"error",title:"Error",text:d,showConfirmButton:!1,timer:3e3})},[d]),t.useEffect(()=>{h==!1&&y!=null&&P(void 0)},[h]),s.jsxs(s.Fragment,{children:[s.jsx(t.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(re,{open:h,onClose:()=>A(!1),action:V,selectedData:y,refresh:()=>f(!0)})}),s.jsx(Q,{variant:"h6",fontWeight:"bold",sx:{ml:"50px",mb:"20px"},children:"Employees"}),s.jsxs(X,{elevation:24,sx:{display:"flex",flexDirection:"column",height:"100%",maxHeight:"700px",borderRadius:"20px",p:"30px",gap:3},children:[s.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"start",gap:1},children:[s.jsx(Y,{placeholder:"Search Employeees...",size:"small",onChange:e=>G(e.target.value),sx:{width:"50%"}}),s.jsx(Z,{color:"primary",icon:"Add",title:"Add",onClick:()=>o("Add")})]}),v?s.jsx(c,{sx:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},children:s.jsx(w,{})}):s.jsx(q,{sx:{flexGrow:1},children:s.jsxs(J,{stickyHeader:!0,children:[s.jsx(ee,{children:s.jsx(B,{children:L.map((e,n)=>s.jsx(l,{size:"small",align:"center",sx:{fontWeight:"bold",backgroundColor:"#F5F5F5",padding:"15px"},children:e},n))})}),s.jsx(se,{children:H.map(e=>s.jsxs(B,{children:[s.jsx(l,{align:"center",children:e.employee_code}),s.jsx(l,{align:"center",children:e.fname}),s.jsx(l,{align:"center",children:e.mname}),s.jsx(l,{align:"center",children:e.lname}),s.jsx(l,{align:"center",children:e.date_of_birth}),s.jsx(l,{align:"center",children:e.employment_status===1?s.jsx(te,{}):s.jsx(ne,{})}),s.jsx(l,{align:"center",children:e.start_date}),s.jsx(l,{align:"center",children:e.end_date}),$(e)]},e.id))})]})}),s.jsxs(c,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center"},children:[s.jsx(k,{size:"medium",disabled:!z,onClick:()=>E("Prev"),children:s.jsx(le,{})}),r+" of "+N,s.jsx(k,{size:"medium",disabled:!R,onClick:()=>E("Next"),children:s.jsx(ae,{})})]})]})]})};export{xe as default};
